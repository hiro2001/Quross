//段差120[mm]

#include "mbed.h"
#define ON 1
#define OFF 0

Serial serial_servo(p9,p10);
Serial pc(USBTX,USBRX);

unsigned short mask_h = 65408; //マスク処理上8bits(0b1111111110000000)
unsigned short mask_l = 127;   //マスク処理下8bits(0b0000000001111111)

int i,j,k;
int n;
int crawl_count=0;
int back_count=0;
int up_count=0;
int front_count=0;
int bstep_count=0;
char ch,flag_open,flag_close,flag_back,flag_up,flag_front,flag_crawl,flag_step,flag_bstep;
unsigned char tx[3];
int crawl_max=40;
int back_max=20;
int up_max=100;
int front_max=100;
int bstep_max=200;
//                       -LB-           -LF-            -RB-           -RF-
int crawl[40][12]={{6268,7335,8428,8675,7462,10626,6226,7551,8534,8671,7449,10430},
                    {6381,7421,8585,8672,7446,10634,6225,7567,8524,8674,7462,10442},
                    {6454,7511,8711,8669,7430,10641,6224,7583,8513,8677,7475,10453},
                    {6480,7600,8795,8665,7413,10649,6222,7600,8502,8679,7488,10464},
                    {6458,7684,8828,8661,7397,10656,6220,7617,8490,8681,7502,10475},
                    {6398,7756,8810,8657,7380,10663,6217,7634,8478,8682,7515,10486},
                    {6311,7811,8745,8652,7363,10670,6214,7652,8466,8684,7529,10496},
                    {6211,7843,8642,8647,7346,10676,6211,7670,8453,8685,7543,10507},
                    {6214,7829,8635,8748,7359,10711,6207,7688,8440,8686,7557,10517},
                    {6216,7815,8628,8842,7415,10721,6203,7707,8426,8687,7571,10527},
                    {6219,7800,8621,8905,7501,10700,6198,7727,8412,8687,7585,10537},
                    {6221,7786,8614,8922,7600,10648,6193,7747,8398,8687,7600,10547},
                    {6223,7771,8606,8891,7691,10575,6187,7768,8382,8687,7615,10556},
                    {6224,7756,8599,8825,7761,10495,6181,7790,8367,8686,7630,10566},
                    {6225,7741,8590,8741,7803,10422,6175,7812,8351,8686,7645,10575},
                    {6226,7726,8582,8654,7814,10371,6167,7836,8334,8685,7660,10584},
                    {6227,7711,8573,8658,7802,10383,6159,7860,8316,8683,7675,10593},
                    {6227,7696,8564,8662,7789,10395,6151,7886,8298,8682,7690,10601},
                    {6227,7681,8554,8665,7777,10407,6141,7913,8279,8680,7706,10610},
                    {6227,7665,8545,8668,7764,10419,6131,7942,8260,8677,7722,10618},
                    {6226,7649,8534,8671,7751,10430,6268,7865,8428,8675,7738,10626},
                    {6225,7633,8524,8674,7738,10442,6381,7779,8585,8672,7754,10634},
                    {6224,7617,8513,8677,7725,10453,6454,7689,8711,8669,7770,10641},
                    {6222,7600,8502,8679,7712,10464,6480,7600,8795,8665,7787,10649},
                    {6220,7583,8490,8681,7698,10475,6458,7516,8828,8661,7803,10656},
                    {6217,7566,8478,8682,7685,10486,6398,7444,8810,8657,7820,10663},
                    {6214,7548,8466,8684,7671,10496,6311,7389,8745,8652,7837,10670},
                    {6211,7530,8453,8685,7657,10507,6211,7357,8642,8647,7854,10676},
                    {6207,7512,8440,8686,7643,10517,6214,7371,8635,8748,7841,10711},
                    {6203,7493,8426,8687,7629,10527,6216,7385,8628,8842,7785,10721},
                    {6198,7473,8412,8687,7615,10537,6219,7400,8621,8905,7699,10700},
                    {6193,7453,8398,8687,7600,10547,6221,7414,8614,8922,7600,10648},
                    {6187,7432,8382,8687,7585,10556,6223,7429,8606,8891,7509,10575},
                    {6181,7410,8367,8686,7570,10566,6224,7444,8599,8825,7439,10495},
                    {6175,7388,8351,8686,7555,10575,6225,7459,8590,8741,7397,10422},
                    {6167,7364,8334,8685,7540,10584,6226,7474,8582,8654,7386,10371},
                    {6159,7340,8316,8683,7525,10593,6227,7489,8573,8658,7398,10383},
                    {6151,7314,8298,8682,7510,10601,6227,7504,8564,8662,7411,10395},
                    {6141,7287,8279,8680,7494,10610,6227,7519,8554,8665,7423,10407},
                    {6131,7258,8260,8677,7478,10618,6227,7535,8545,8668,7436,10419}};

int back[20][12]={{8998,7603,10680,8922,7600,10648,8998,7597,10680,8922,7600,10648},
                    {9075,7613,10714,8922,7600,10648,9075,7587,10714,8922,7600,10648},
                    {9150,7629,10751,8922,7600,10648,9150,7571,10751,8922,7600,10648},
                    {9222,7653,10788,8922,7600,10648,9222,7547,10788,8922,7600,10648},
                    {9290,7683,10825,8922,7600,10648,9290,7517,10825,8922,7600,10648},
                    {9350,7721,10861,8922,7600,10648,9350,7479,10861,8922,7600,10648},
                    {9401,7765,10896,8922,7600,10648,9401,7435,10896,8922,7600,10648},
                    {9441,7816,10928,8922,7600,10648,9441,7384,10928,8922,7600,10648},
                    {9467,7872,10957,8922,7600,10648,9467,7328,10957,8922,7600,10648},
                    {9477,7930,10980,8922,7600,10648,9477,7270,10980,8922,7600,10648},
                    {9469,7990,10997,8922,7600,10648,9469,7210,10997,8922,7600,10648},
                    {9444,8049,11009,8922,7600,10648,9444,7151,11009,8922,7600,10648},
                    {9399,8102,11013,8922,7600,10648,9399,7098,11013,8922,7600,10648},
                    {9337,8148,11009,8922,7600,10648,9337,7052,11009,8922,7600,10648},
                    {9260,8184,10999,8922,7600,10648,9260,7016,10999,8922,7600,10648},
                    {9171,8209,10983,8922,7600,10648,9171,6991,10983,8922,7600,10648},
                    {9075,8222,10960,8922,7600,10648,9075,6978,10960,8922,7600,10648},
                    {8976,8225,10932,8922,7600,10648,8976,6975,10932,8922,7600,10648},
                    {8878,8217,10901,8922,7600,10648,8878,6983,10901,8922,7600,10648},
                    {8785,8201,10866,8922,7600,10648,8785,6999,10866,8922,7600,10648}};

int up[100][12]={{8785,8201,10866,8922,7600,10648,8785,6999,10866,8922,7600,10648},
                {8749,8193,10851,8891,7600,10636,8749,7007,10851,8891,7600,10636},
                {8713,8185,10836,8860,7600,10623,8713,7015,10836,8860,7600,10623},
                {8677,8177,10821,8829,7600,10610,8677,7023,10821,8829,7600,10610},
                {8642,8169,10806,8798,7600,10597,8642,7031,10806,8798,7600,10597},
                {8607,8162,10791,8768,7600,10583,8607,7038,10791,8768,7600,10583},
                {8573,8155,10776,8738,7600,10570,8573,7045,10776,8738,7600,10570},
                {8540,8148,10760,8708,7600,10556,8540,7052,10760,8708,7600,10556},
                {8507,8141,10744,8678,7600,10542,8507,7059,10744,8678,7600,10542},
                {8474,8135,10729,8648,7600,10529,8474,7065,10729,8648,7600,10529},
                {8442,8128,10713,8619,7600,10514,8442,7072,10713,8619,7600,10514},
                {8410,8122,10697,8590,7600,10500,8410,7078,10697,8590,7600,10500},
                {8378,8116,10681,8561,7600,10486,8378,7084,10681,8561,7600,10486},
                {8347,8110,10665,8532,7600,10471,8347,7090,10665,8532,7600,10471},
                {8317,8105,10649,8504,7600,10457,8317,7095,10649,8504,7600,10457},
                {8287,8099,10632,8475,7600,10442,8287,7101,10632,8475,7600,10442},
                {8257,8094,10616,8447,7600,10427,8257,7106,10616,8447,7600,10427},
                {8227,8089,10599,8419,7600,10412,8227,7111,10599,8419,7600,10412},
                {8198,8083,10583,8391,7600,10397,8198,7117,10583,8391,7600,10397},
                {8169,8079,10566,8364,7600,10382,8169,7121,10566,8364,7600,10382},
                {8140,8074,10549,8336,7600,10366,8140,7126,10549,8336,7600,10366},
                {8112,8069,10532,8309,7600,10351,8112,7131,10532,8309,7600,10351},
                {8084,8065,10515,8282,7600,10335,8084,7135,10515,8282,7600,10335},
                {8056,8060,10498,8255,7600,10319,8056,7140,10498,8255,7600,10319},
                {8029,8056,10481,8228,7600,10303,8029,7144,10481,8228,7600,10303},
                {8002,8052,10464,8201,7600,10287,8002,7148,10464,8201,7600,10287},
                {7975,8048,10446,8174,7600,10271,7975,7152,10446,8174,7600,10271},
                {7948,8044,10429,8148,7600,10255,7948,7156,10429,8148,7600,10255},
                {7921,8040,10411,8122,7600,10239,7921,7160,10411,8122,7600,10239},
                {7895,8036,10393,8096,7600,10222,7895,7164,10393,8096,7600,10222},
                {7869,8033,10376,8070,7600,10205,7869,7167,10376,8070,7600,10205},
                {7843,8029,10358,8044,7600,10188,7843,7171,10358,8044,7600,10188},
                {7817,8026,10340,8018,7600,10171,7817,7174,10340,8018,7600,10171},
                {7792,8023,10322,7992,7600,10154,7792,7177,10322,7992,7600,10154},
                {7767,8020,10304,7967,7600,10137,7767,7180,10304,7967,7600,10137},
                {7741,8017,10285,7941,7600,10120,7741,7183,10285,7941,7600,10120},
                {7716,8014,10267,7916,7600,10102,7716,7186,10267,7916,7600,10102},
                {7692,8011,10248,7891,7600,10085,7692,7189,10248,7891,7600,10085},
                {7667,8008,10230,7865,7600,10067,7667,7192,10230,7865,7600,10067},
                {7642,8006,10211,7840,7600,10049,7642,7194,10211,7840,7600,10049},
                {7618,8003,10192,7815,7600,10031,7618,7197,10192,7815,7600,10031},
                {7594,8001,10173,7791,7600,10013,7594,7199,10173,7791,7600,10013},
                {7570,7998,10154,7766,7600,9995,7570,7202,10154,7766,7600,9995},
                {7545,7996,10135,7741,7600,9976,7545,7204,10135,7741,7600,9976},
                {7522,7994,10116,7716,7600,9958,7522,7206,10116,7716,7600,9958},
                {7498,7992,10097,7692,7600,9939,7498,7208,10097,7692,7600,9939},
                {7474,7990,10077,7667,7600,9920,7474,7210,10077,7667,7600,9920},
                {7450,7988,10058,7643,7600,9901,7450,7212,10058,7643,7600,9901},
                {7427,7986,10038,7618,7600,9882,7427,7214,10038,7618,7600,9882},
                {7403,7984,10018,7594,7600,9863,7403,7216,10018,7594,7600,9863},
                {7380,7982,9998,7569,7600,9843,7380,7218,9998,7569,7600,9843},
                {7356,7981,9978,7545,7600,9823,7356,7219,9978,7545,7600,9823},
                {7333,7979,9958,7521,7600,9804,7333,7221,9958,7521,7600,9804},
                {7310,7978,9938,7496,7600,9784,7310,7222,9938,7496,7600,9784},
                {7286,7977,9917,7472,7600,9764,7286,7223,9917,7472,7600,9764},
                {7263,7975,9897,7448,7600,9743,7263,7225,9897,7448,7600,9743},
                {7240,7974,9876,7423,7600,9723,7240,7226,9876,7423,7600,9723},
                {7217,7973,9855,7399,7600,9702,7217,7227,9855,7399,7600,9702},
                {7194,7972,9834,7375,7600,9681,7194,7228,9834,7375,7600,9681},
                {7171,7971,9813,7351,7600,9660,7171,7229,9813,7351,7600,9660},
                {7148,7970,9791,7326,7600,9639,7148,7230,9791,7326,7600,9639},
                {7125,7970,9770,7302,7600,9618,7125,7230,9770,7302,7600,9618},
                {7102,7969,9748,7278,7600,9596,7102,7231,9748,7278,7600,9596},
                {7078,7969,9726,7253,7600,9574,7078,7231,9726,7253,7600,9574},
                {7055,7968,9704,7229,7600,9552,7055,7232,9704,7229,7600,9552},
                {7032,7968,9682,7204,7600,9530,7032,7232,9682,7204,7600,9530},
                {7009,7968,9660,7180,7600,9507,7009,7232,9660,7180,7600,9507},
                {6986,7967,9637,7155,7600,9485,6986,7233,9637,7155,7600,9485},
                {6962,7967,9614,7131,7600,9462,6962,7233,9614,7131,7600,9462},
                {6939,7967,9591,7106,7600,9439,6939,7233,9591,7106,7600,9439},
                {6916,7968,9568,7081,7600,9415,6916,7232,9568,7081,7600,9415},
                {6892,7968,9544,7056,7600,9391,6892,7232,9544,7056,7600,9391},
                {6869,7968,9521,7031,7600,9367,6869,7232,9521,7031,7600,9367},
                {6845,7969,9497,7006,7600,9343,6845,7231,9497,7006,7600,9343},
                {6821,7970,9473,6981,7600,9318,6821,7230,9473,6981,7600,9318},
                {6798,7970,9448,6956,7600,9293,6798,7230,9448,6956,7600,9293},
                {6774,7971,9424,6930,7600,9268,6774,7229,9424,6930,7600,9268},
                {6750,7972,9399,6904,7600,9243,6750,7228,9399,6904,7600,9243},
                {6725,7973,9374,6878,7600,9217,6725,7227,9374,6878,7600,9217},
                {6701,7975,9348,6852,7600,9190,6701,7225,9348,6852,7600,9190},
                {6677,7976,9322,6826,7600,9164,6677,7224,9322,6826,7600,9164},
                {6652,7978,9296,6800,7600,9137,6652,7222,9296,6800,7600,9137},
                {6627,7980,9270,6773,7600,9109,6627,7220,9270,6773,7600,9109},
                {6602,7982,9243,6746,7600,9081,6602,7218,9243,6746,7600,9081},
                {6577,7984,9216,6719,7600,9053,6577,7216,9216,6719,7600,9053},
                {6551,7987,9188,6691,7600,9024,6551,7213,9188,6691,7600,9024},
                {6526,7990,9160,6664,7600,8995,6526,7210,9160,6664,7600,8995},
                {6500,7993,9132,6636,7600,8965,6500,7207,9132,6636,7600,8965},
                {6474,7996,9103,6607,7600,8934,6474,7204,9103,6607,7600,8934},
                {6447,8000,9074,6578,7600,8903,6447,7200,9074,6578,7600,8903},
                {6420,8004,9044,6549,7600,8871,6420,7196,9044,6549,7600,8871},
                {6393,8008,9014,6519,7600,8839,6393,7192,9014,6519,7600,8839},
                {6365,8012,8983,6489,7600,8805,6365,7188,8983,6489,7600,8805},
                {6337,8018,8951,6458,7600,8771,6337,7182,8951,6458,7600,8771},
                {6309,8023,8919,6427,7600,8736,6309,7177,8919,6427,7600,8736},
                {6280,8029,8887,6395,7600,8700,6280,7171,8887,6395,7600,8700},
                {6250,8036,8853,6362,7600,8663,6250,7164,8853,6362,7600,8663},
                {6220,8044,8819,6328,7600,8625,6220,7156,8819,6328,7600,8625},
                {6190,8052,8784,6294,7600,8585,6190,7148,8784,6294,7600,8585},
                {6158,8061,8748,6258,7600,8544,6158,7139,8748,6258,7600,8544}};

int front[100][12]={{6126,8071,8711,6328,7565,8604,6126,7129,8711,6328,7635,8604},
                    {6126,8071,8711,6426,7534,8695,6126,7129,8711,6426,7666,8695},
                    {6126,8071,8711,6520,7506,8778,6126,7129,8711,6520,7694,8778},
                    {6126,8071,8711,6608,7479,8855,6126,7129,8711,6608,7721,8855},
                    {6126,8071,8711,6693,7454,8925,6126,7129,8711,6693,7746,8925},
                    {6126,8071,8711,6775,7429,8991,6126,7129,8711,6775,7771,8991},
                    {6126,8071,8711,6854,7404,9051,6126,7129,8711,6854,7796,9051},
                    {6126,8071,8711,6931,7380,9108,6126,7129,8711,6931,7820,9108},
                    {6126,8071,8711,7006,7356,9160,6126,7129,8711,7006,7844,9160},
                    {6126,8071,8711,7078,7332,9209,6126,7129,8711,7078,7868,9209},
                    {6126,8071,8711,7149,7308,9255,6126,7129,8711,7149,7892,9255},
                    {6126,8071,8711,7218,7283,9297,6126,7129,8711,7218,7917,9297},
                    {6126,8071,8711,7286,7259,9336,6126,7129,8711,7286,7941,9336},
                    {6126,8071,8711,7351,7234,9371,6126,7129,8711,7351,7966,9371},
                    {6126,8071,8711,7415,7209,9404,6126,7129,8711,7415,7991,9404},
                    {6126,8071,8711,7478,7184,9434,6126,7129,8711,7478,8016,9434},
                    {6126,8071,8711,7539,7158,9461,6126,7129,8711,7539,8042,9461},
                    {6126,8071,8711,7598,7133,9485,6126,7129,8711,7598,8067,9485},
                    {6126,8071,8711,7656,7107,9506,6126,7129,8711,7656,8093,9506},
                    {6126,8071,8711,7712,7080,9525,6126,7129,8711,7712,8120,9525},
                    {6126,8071,8711,7766,7054,9540,6126,7129,8711,7766,8146,9540},
                    {6126,8071,8711,7819,7027,9553,6126,7129,8711,7819,8173,9553},
                    {6126,8071,8711,7869,7000,9563,6126,7129,8711,7869,8200,9563},
                    {6126,8071,8711,7918,6973,9570,6126,7129,8711,7918,8227,9570},
                    {6126,8071,8711,7965,6946,9574,6126,7129,8711,7965,8254,9574},
                    {6126,8071,8711,8009,6918,9576,6126,7129,8711,8009,8282,9576},
                    {6126,8071,8711,8051,6890,9575,6126,7129,8711,8051,8310,9575},
                    {6126,8071,8711,8091,6862,9571,6126,7129,8711,8091,8338,9571},
                    {6126,8071,8711,8128,6834,9564,6126,7129,8711,8128,8366,9564},
                    {6126,8071,8711,8163,6805,9554,6126,7129,8711,8163,8395,9554},
                    {6126,8071,8711,8195,6776,9542,6126,7129,8711,8195,8424,9542},
                    {6126,8071,8711,8224,6746,9527,6126,7129,8711,8224,8454,9527},
                    {6126,8071,8711,8250,6716,9509,6126,7129,8711,8250,8484,9509},
                    {6126,8071,8711,8273,6685,9488,6126,7129,8711,8273,8515,9488},
                    {6126,8071,8711,8293,6653,9464,6126,7129,8711,8293,8547,9464},
                    {6126,8071,8711,8310,6620,9437,6126,7129,8711,8310,8580,9437},
                    {6126,8071,8711,8322,6585,9408,6126,7129,8711,8322,8615,9408},
                    {6126,8071,8711,8331,6549,9375,6126,7129,8711,8331,8651,9375},
                    {6126,8071,8711,8336,6510,9340,6126,7129,8711,8336,8690,9340},
                    {6126,8071,8711,8337,6469,9301,6126,7129,8711,8337,8731,9301},
                    {6126,8071,8711,8333,6425,9259,6126,7129,8711,8333,8775,9259},
                    {6126,8071,8711,8324,6376,9214,6126,7129,8711,8324,8824,9214},
                    {6126,8071,8711,8309,6322,9166,6126,7129,8711,8309,8878,9166},
                    {6126,8071,8711,8288,6260,9114,6126,7129,8711,8288,8940,9114},
                    {6126,8071,8711,8259,6190,9058,6126,7129,8711,8259,9010,9058},
                    {6126,8071,8711,8221,6107,8998,6126,7129,8711,8221,9093,8998},
                    {6126,8071,8711,8171,6005,8933,6126,7129,8711,8171,9195,8933},
                    {6126,8071,8711,8104,5876,8863,6126,7129,8711,8104,9324,8863},
                    {6126,8071,8711,8010,5697,8787,6126,7129,8711,8010,9503,8787},
                    {6126,8071,8711,7855,5403,8705,6126,7129,8711,7855,9797,8705},
                    {6126,8071,8711,8037,5712,8773,6126,7129,8711,8037,9488,8773},
                    {6126,8071,8711,8158,5907,8837,6126,7129,8711,8158,9293,8837},
                    {6126,8071,8711,8252,6055,8897,6126,7129,8711,8252,9145,8897},
                    {6126,8071,8711,8331,6175,8954,6126,7129,8711,8331,9025,8954},
                    {6126,8071,8711,8398,6276,9009,6126,7129,8711,8398,8924,9009},
                    {6126,8071,8711,8458,6365,9060,6126,7129,8711,8458,8835,9060},
                    {6126,8071,8711,8510,6443,9109,6126,7129,8711,8510,8757,9109},
                    {6126,8071,8711,8558,6515,9156,6126,7129,8711,8558,8685,9156},
                    {6126,8071,8711,8600,6580,9201,6126,7129,8711,8600,8620,9201},
                    {6126,8071,8711,8639,6641,9244,6126,7129,8711,8639,8559,9244},
                    {6126,8071,8711,8674,6698,9285,6126,7129,8711,8674,8502,9285},
                    {6126,8071,8711,8706,6752,9324,6126,7129,8711,8706,8448,9324},
                    {6126,8071,8711,8735,6803,9361,6126,7129,8711,8735,8397,9361},
                    {6126,8071,8711,8761,6852,9397,6126,7129,8711,8761,8348,9397},
                    {6126,8071,8711,8784,6900,9431,6126,7129,8711,8784,8300,9431},
                    {6126,8071,8711,8805,6946,9463,6126,7129,8711,8805,8254,9463},
                    {6126,8071,8711,8824,6990,9494,6126,7129,8711,8824,8210,9494},
                    {6126,8071,8711,8840,7034,9524,6126,7129,8711,8840,8166,9524},
                    {6126,8071,8711,8854,7077,9552,6126,7129,8711,8854,8123,9552},
                    {6126,8071,8711,8867,7120,9578,6126,7129,8711,8867,8080,9578},
                    {6126,8071,8711,8877,7161,9603,6126,7129,8711,8877,8039,9603},
                    {6126,8071,8711,8885,7203,9627,6126,7129,8711,8885,7997,9627},
                    {6126,8071,8711,8891,7244,9649,6126,7129,8711,8891,7956,9649},
                    {6126,8071,8711,8896,7284,9669,6126,7129,8711,8896,7916,9669},
                    {6126,8071,8711,8899,7325,9688,6126,7129,8711,8899,7875,9688},
                    {6126,8071,8711,8899,7365,9706,6126,7129,8711,8899,7835,9706},
                    {6126,8071,8711,8899,7406,9722,6126,7129,8711,8899,7794,9722},
                    {6126,8071,8711,8896,7446,9737,6126,7129,8711,8896,7754,9737},
                    {6126,8071,8711,8891,7486,9750,6126,7129,8711,8891,7714,9750},
                    {6126,8071,8711,8885,7527,9762,6126,7129,8711,8885,7673,9762},
                    {6126,8071,8711,8877,7567,9773,6126,7129,8711,8877,7633,9773},
                    {6126,8071,8711,8867,7607,9782,6126,7129,8711,8867,7593,9782},
                    {6126,8071,8711,8856,7648,9789,6126,7129,8711,8856,7552,9789},
                    {6126,8071,8711,8842,7688,9796,6126,7129,8711,8842,7512,9796},
                    {6126,8071,8711,8827,7729,9800,6126,7129,8711,8827,7471,9800},
                    {6126,8071,8711,8811,7770,9803,6126,7129,8711,8811,7430,9803},
                    {6126,8071,8711,8792,7810,9805,6126,7129,8711,8792,7390,9805},
                    {6126,8071,8711,8772,7851,9806,6126,7129,8711,8772,7349,9806},
                    {6126,8071,8711,8750,7892,9804,6126,7129,8711,8750,7308,9804},
                    {6126,8071,8711,8726,7933,9802,6126,7129,8711,8726,7267,9802},
                    {6126,8071,8711,8700,7974,9798,6126,7129,8711,8700,7226,9798},
                    {6126,8071,8711,8672,8016,9792,6126,7129,8711,8672,7184,9792},
                    {6126,8071,8711,8643,8057,9785,6126,7129,8711,8643,7143,9785},
                    {6126,8071,8711,8611,8099,9777,6126,7129,8711,8611,7101,9777},
                    {6126,8071,8711,8578,8141,9767,6126,7129,8711,8578,7059,9767},
                    {6126,8071,8711,8543,8183,9756,6126,7129,8711,8543,7017,9756},
                    {6126,8071,8711,8506,8225,9743,6126,7129,8711,8506,6975,9743},
                    {6126,8071,8711,8467,8268,9729,6126,7129,8711,8467,6932,9729},
                    {6126,8071,8711,8425,8311,9713,6126,7129,8711,8425,6889,9713},
                    {6126,8071,8711,8382,8355,9696,6126,7129,8711,8382,6845,9696}};

int bstep[200][12]={{6390,7332,8511,8512,7049,10750,6193,7747,8398,8643,7244,10592},
                    {6608,7366,8705,8507,7042,10751,6193,7747,8398,8644,7249,10597},
                    {6804,7385,8865,8503,7034,10752,6193,7747,8398,8644,7254,10601},
                    {6985,7397,9000,8498,7027,10753,6193,7747,8398,8645,7259,10606},
                    {7157,7404,9117,8493,7019,10754,6193,7747,8398,8645,7264,10611},
                    {7321,7409,9218,8488,7012,10755,6193,7747,8398,8646,7269,10615},
                    {7478,7412,9304,8483,7004,10756,6193,7747,8398,8646,7275,10620},
                    {7629,7414,9377,8478,6997,10756,6193,7747,8398,8647,7280,10624},
                    {7773,7416,9438,8473,6989,10757,6193,7747,8398,8647,7285,10629},
                    {7911,7417,9487,8467,6982,10758,6193,7747,8398,8647,7291,10633},
                    {8042,7417,9524,8462,6974,10758,6193,7747,8398,8647,7296,10638},
                    {8165,7417,9549,8456,6967,10759,6193,7747,8398,8648,7301,10642},
                    {8280,7417,9563,8451,6959,10759,6193,7747,8398,8648,7307,10646},
                    {8386,7417,9565,8445,6952,10760,6193,7747,8398,8648,7312,10651},
                    {8483,7417,9555,8440,6944,10760,6193,7747,8398,8648,7318,10655},
                    {8568,7417,9534,8434,6937,10761,6193,7747,8398,8648,7323,10659},
                    {8642,7417,9501,8428,6929,10761,6193,7747,8398,8648,7329,10664},
                    {8705,7416,9456,8422,6922,10761,6193,7747,8398,8648,7334,10668},
                    {8754,7415,9400,8416,6914,10762,6193,7747,8398,8648,7340,10672},
                    {8791,7413,9331,8410,6907,10762,6193,7747,8398,8647,7346,10676},
                    {8863,7421,9462,8404,6899,10762,6193,7747,8398,8647,7351,10680},
                    {8927,7427,9586,8398,6892,10762,6193,7747,8398,8647,7357,10685},
                    {8984,7431,9703,8392,6884,10762,6193,7747,8398,8647,7363,10689},
                    {9034,7434,9813,8385,6877,10762,6193,7747,8398,8646,7369,10693},
                    {9077,7436,9919,8379,6870,10762,6193,7747,8398,8646,7374,10697},
                    {9113,7438,10019,8373,6862,10762,6193,7747,8398,8645,7380,10701},
                    {9142,7439,10115,8366,6855,10762,6193,7747,8398,8645,7386,10705},
                    {9163,7439,10207,8359,6847,10762,6193,7747,8398,8644,7392,10709},
                    {9176,7439,10293,8353,6840,10762,6193,7747,8398,8643,7398,10713},
                    {9181,7439,10376,8346,6833,10762,6193,7747,8398,8643,7404,10716},
                    {9176,7439,10453,8339,6825,10761,6193,7747,8398,8642,7410,10720},
                    {9161,7438,10526,8332,6818,10761,6193,7747,8398,8641,7416,10724},
                    {9134,7438,10593,8325,6811,10761,6193,7747,8398,8640,7422,10728},
                    {9094,7437,10655,8318,6803,10760,6193,7747,8398,8639,7428,10732},
                    {9040,7438,10710,8311,6796,10760,6193,7747,8398,8638,7435,10735},
                    {8971,7438,10758,8303,6789,10760,6193,7747,8398,8637,7441,10739},
                    {8886,7440,10798,8296,6782,10759,6193,7747,8398,8636,7447,10743},
                    {8785,7443,10830,8288,6774,10759,6193,7747,8398,8635,7453,10746},
                    {8666,7447,10853,8281,6767,10758,6193,7747,8398,8634,7460,10750},
                    {8532,7453,10867,8273,6760,10757,6193,7747,8398,8633,7466,10754},
                    {8535,7446,10864,8305,6752,10772,6193,7747,8398,8631,7472,10757},
                    {8538,7439,10861,8340,6747,10786,6193,7747,8398,8630,7479,10761},
                    {8540,7432,10858,8379,6745,10801,6193,7747,8398,8628,7485,10764},
                    {8543,7425,10855,8422,6748,10815,6193,7747,8398,8627,7492,10768},
                    {8546,7418,10852,8468,6755,10829,6193,7747,8398,8625,7498,10771},
                    {8548,7411,10848,8516,6765,10842,6193,7747,8398,8624,7505,10774},
                    {8550,7405,10845,8566,6781,10855,6193,7747,8398,8622,7511,10778},
                    {8553,7398,10842,8617,6800,10867,6193,7747,8398,8620,7518,10781},
                    {8555,7391,10839,8669,6825,10877,6193,7747,8398,8619,7525,10784},
                    {8557,7385,10835,8719,6853,10886,6193,7747,8398,8617,7531,10787},
                    {8559,7378,10832,8768,6887,10893,6193,7747,8398,8615,7538,10791},
                    {8561,7372,10829,8815,6924,10897,6193,7747,8398,8613,7545,10794},
                    {8563,7365,10825,8858,6965,10900,6193,7747,8398,8611,7551,10797},
                    {8565,7359,10822,8898,7010,10899,6193,7747,8398,8609,7558,10800},
                    {8567,7352,10818,8934,7057,10896,6193,7747,8398,8607,7565,10803},
                    {8569,7346,10815,8965,7107,10890,6193,7747,8398,8604,7572,10806},
                    {8571,7339,10811,8990,7157,10882,6193,7747,8398,8602,7579,10809},
                    {8572,7333,10808,9011,7209,10870,6193,7747,8398,8600,7586,10812},
                    {8574,7327,10804,9027,7261,10856,6193,7747,8398,8597,7593,10815},
                    {8576,7321,10800,9037,7311,10839,6193,7747,8398,8595,7600,10818},
                    {8577,7315,10797,9043,7361,10820,6193,7747,8398,8593,7607,10821},
                    {8578,7308,10793,9043,7409,10798,6193,7747,8398,8590,7614,10823},
                    {8580,7302,10789,9040,7455,10774,6193,7747,8398,8587,7621,10826},
                    {8581,7296,10785,9032,7498,10749,6193,7747,8398,8585,7628,10829},
                    {8582,7290,10782,9020,7539,10723,6193,7747,8398,8582,7636,10832},
                    {8584,7284,10778,9006,7576,10695,6193,7747,8398,8579,7643,10834},
                    {8585,7278,10774,8988,7611,10667,6193,7747,8398,8576,7650,10837},
                    {8586,7272,10770,8968,7643,10639,6193,7747,8398,8573,7657,10839},
                    {8587,7266,10766,8946,7673,10610,6193,7747,8398,8570,7665,10842},
                    {8588,7261,10762,8921,7699,10582,6193,7747,8398,8567,7672,10844},
                    {8589,7255,10758,8896,7722,10555,6193,7747,8398,8564,7680,10847},
                    {8590,7249,10754,8870,7743,10528,6193,7747,8398,8561,7687,10849},
                    {8591,7243,10750,8842,7761,10502,6193,7747,8398,8557,7694,10852},
                    {8591,7238,10746,8815,7776,10478,6193,7747,8398,8554,7702,10854},
                    {8592,7232,10742,8787,7789,10455,6193,7747,8398,8551,7709,10856},
                    {8593,7226,10737,8760,7799,10434,6193,7747,8398,8547,7717,10858},
                    {8593,7221,10733,8732,7806,10415,6193,7747,8398,8543,7724,10861},
                    {8594,7215,10729,8706,7811,10398,6193,7747,8398,8540,7732,10863},
                    {8594,7210,10725,8680,7814,10383,6193,7747,8398,8536,7740,10865},
                    {8595,7204,10721,8654,7814,10371,6193,7747,8398,8532,7747,10867},
                    {8595,7199,10716,8656,7809,10376,6193,7747,8398,8529,7755,10869},
                    {8595,7194,10712,8657,7804,10380,6193,7747,8398,8525,7763,10871},
                    {8596,7188,10708,8659,7799,10385,6193,7747,8398,8521,7770,10873},
                    {8596,7183,10703,8660,7794,10390,6193,7747,8398,8517,7778,10875},
                    {8596,7178,10699,8662,7789,10395,6193,7747,8398,8512,7786,10877},
                    {8596,7172,10694,8663,7784,10400,6193,7747,8398,8508,7794,10878},
                    {8596,7167,10690,8665,7779,10404,6193,7747,8398,8504,7802,10880},
                    {8596,7162,10685,8666,7774,10409,6193,7747,8398,8500,7809,10882},
                    {8596,7157,10681,8667,7769,10414,6193,7747,8398,8495,7817,10884},
                    {8596,7152,10676,8668,7764,10419,6193,7747,8398,8491,7825,10885},
                    {8596,7146,10672,8670,7759,10423,6193,7747,8398,8486,7833,10887},
                    {8596,7141,10667,8671,7754,10428,6193,7747,8398,8482,7841,10888},
                    {8596,7136,10662,8672,7749,10432,6193,7747,8398,8477,7849,10890},
                    {8595,7131,10658,8673,7743,10437,6193,7747,8398,8472,7857,10891},
                    {8595,7126,10653,8674,7738,10442,6193,7747,8398,8467,7865,10893},
                    {8595,7121,10648,8675,7733,10446,6193,7747,8398,8462,7873,10894},
                    {8594,7116,10644,8676,7728,10451,6193,7747,8398,8457,7881,10896},
                    {8594,7112,10639,8677,7722,10455,6193,7747,8398,8452,7889,10897},
                    {8593,7107,10634,8678,7717,10459,6193,7747,8398,8447,7897,10898},
                    {8592,7102,10629,8679,7712,10464,6193,7747,8398,8442,7905,10899},
                    {8592,7097,10624,8680,7706,10468,6437,7703,8643,8437,7913,10900},
                    {8591,7092,10620,8680,7701,10473,6650,7676,8841,8431,7921,10901},
                    {8590,7088,10615,8681,7696,10477,6844,7656,9009,8426,7929,10903},
                    {8590,7083,10610,8682,7690,10481,7027,7639,9157,8420,7937,10904},
                    {8589,7078,10605,8682,7685,10486,7203,7623,9287,8415,7945,10904},
                    {8588,7073,10600,8683,7679,10490,7373,7609,9403,8409,7953,10905},
                    {8587,7069,10595,8684,7674,10494,7538,7595,9507,8403,7961,10906},
                    {8586,7064,10590,8684,7668,10498,7700,7582,9599,8397,7969,10907},
                    {8585,7060,10585,8685,7663,10503,7858,7568,9680,8391,7978,10908},
                    {8584,7055,10580,8685,7657,10507,8014,7554,9751,8385,7986,10909},
                    {8583,7050,10575,8686,7651,10511,8165,7540,9811,8379,7994,10909},
                    {8582,7046,10570,8686,7646,10515,8312,7526,9860,8373,8002,10910},
                    {8581,7041,10565,8686,7640,10519,8454,7512,9898,8367,8010,10910},
                    {8579,7037,10560,8686,7635,10523,8589,7497,9926,8361,8018,10911},
                    {8578,7033,10554,8687,7629,10527,8717,7483,9943,8354,8026,10912},
                    {8577,7028,10549,8687,7623,10531,8837,7468,9949,8348,8034,10912},
                    {8575,7024,10544,8687,7617,10535,8947,7454,9943,8341,8042,10912},
                    {8574,7019,10539,8687,7612,10539,9046,7441,9927,8335,8051,10913},
                    {8572,7015,10533,8687,7606,10543,9134,7427,9899,8328,8059,10913},
                    {8571,7011,10528,8687,7600,10547,9210,7414,9861,8321,8067,10913},
                    {8569,7006,10523,8687,7594,10551,9236,7403,9939,8315,8075,10913},
                    {8568,7002,10518,8687,7588,10554,9258,7390,10014,8308,8083,10914},
                    {8566,6998,10512,8687,7582,10558,9275,7377,10086,8301,8091,10914},
                    {8565,6993,10507,8687,7576,10562,9287,7363,10154,8293,8099,10914},
                    {8563,6989,10502,8686,7570,10566,9294,7347,10220,8286,8107,10914},
                    {8561,6985,10496,8686,7565,10569,9296,7331,10283,8279,8115,10914},
                    {8559,6981,10491,8686,7559,10573,9292,7314,10342,8272,8123,10914},
                    {8557,6977,10485,8686,7552,10577,9281,7296,10399,8264,8131,10914},
                    {8556,6972,10480,8685,7546,10580,9264,7276,10452,8257,8139,10913},
                    {8554,6968,10474,8685,7540,10584,9240,7256,10501,8249,8147,10913},
                    {8552,6964,10469,8684,7534,10587,9208,7235,10547,8242,8155,10913},
                    {8550,6960,10463,8684,7528,10591,9168,7214,10589,8234,8163,10913},
                    {8548,6956,10458,8683,7522,10594,9119,7192,10626,8226,8171,10912},
                    {8545,6952,10452,8682,7516,10598,9061,7170,10659,8218,8179,10912},
                    {8543,6948,10447,8682,7510,10601,8994,7148,10687,8210,8187,10911},
                    {8541,6944,10441,8681,7503,10605,8917,7127,10710,8202,8195,10911},
                    {8539,6940,10435,8680,7497,10608,8830,7107,10728,8194,8202,10910},
                    {8537,6936,10430,8679,7491,10611,8734,7088,10741,8186,8210,10910},
                    {8534,6932,10424,8678,7484,10615,8630,7071,10748,8178,8218,10909},
                    {8532,6928,10418,8677,7478,10618,8517,7057,10749,8169,8226,10908},
                    {8530,6924,10413,8676,7472,10621,8521,7064,10748,8201,8234,10925},
                    {8527,6920,10407,8675,7465,10624,8526,7072,10747,8237,8239,10941},
                    {8525,6916,10401,8674,7459,10627,8530,7079,10746,8278,8239,10958},
                    {8522,6912,10395,8673,7452,10631,8534,7086,10745,8322,8236,10974},
                    {8520,6908,10390,8672,7446,10634,8539,7094,10744,8371,8228,10990},
                    {8517,6904,10384,8671,7439,10637,8543,7101,10742,8422,8215,11006},
                    {8515,6900,10378,8669,7433,10640,8547,7109,10741,8477,8197,11020},
                    {8512,6896,10372,8668,7426,10643,8551,7116,10740,8533,8175,11034},
                    {8509,6892,10366,8667,7420,10646,8555,7124,10738,8589,8147,11046},
                    {8507,6888,10360,8665,7413,10649,8559,7131,10737,8646,8113,11056},
                    {8504,6884,10354,8664,7407,10652,8563,7138,10735,8702,8075,11064},
                    {8501,6880,10349,8662,7400,10655,8567,7146,10734,8755,8032,11070},
                    {8498,6877,10343,8660,7393,10657,8570,7153,10732,8806,7984,11072},
                    {8495,6873,10337,8659,7386,10660,8574,7161,10731,8852,7933,11072},
                    {8492,6869,10331,8657,7380,10663,8578,7168,10729,8894,7879,11069},
                    {8489,6865,10325,8655,7373,10666,8581,7175,10728,8931,7823,11062},
                    {8486,6861,10319,8653,7366,10668,8585,7182,10726,8962,7766,11051},
                    {8483,6857,10313,8651,7359,10671,8588,7190,10724,8988,7710,11038},
                    {8480,6854,10307,8649,7353,10674,8591,7197,10722,9007,7654,11021},
                    {8477,6850,10300,8647,7346,10676,8595,7204,10721,9021,7600,11001},
                    {8474,6846,10294,8645,7339,10679,8598,7212,10719,9029,7548,10979},
                    {8471,6842,10288,8643,7332,10681,8601,7219,10717,9031,7500,10954},
                    {8468,6838,10282,8641,7325,10684,8604,7226,10715,9028,7454,10928},
                    {8464,6835,10276,8639,7318,10686,8607,7233,10713,9021,7412,10899},
                    {8461,6831,10270,8636,7311,10689,8610,7240,10711,9010,7374,10870},
                    {8458,6827,10264,8634,7304,10691,8613,7248,10709,8994,7338,10839},
                    {8454,6823,10257,8632,7297,10693,8616,7255,10707,8976,7306,10808},
                    {8451,6819,10251,8629,7290,10696,8619,7262,10705,8954,7277,10777},
                    {8447,6816,10245,8627,7283,10698,8621,7269,10702,8930,7252,10745},
                    {8444,6812,10239,8624,7276,10700,8624,7276,10700,8905,7229,10715},
                    {8440,6808,10232,8621,7269,10702,8627,7283,10698,8877,7209,10685},
                    {8437,6804,10226,8619,7262,10705,8629,7290,10696,8849,7192,10656},
                    {8433,6800,10220,8616,7255,10707,8632,7297,10693,8820,7177,10628},
                    {8430,6797,10213,8613,7248,10709,8634,7304,10691,8791,7165,10602},
                    {8426,6793,10207,8610,7240,10711,8636,7311,10689,8761,7155,10578},
                    {8422,6789,10200,8607,7233,10713,8639,7318,10686,8731,7148,10556},
                    {8418,6785,10194,8604,7226,10715,8641,7325,10684,8702,7143,10536},
                    {8415,6781,10188,8601,7219,10717,8643,7332,10681,8674,7141,10518},
                    {8411,6778,10181,8598,7212,10719,8645,7339,10679,8646,7140,10502},
                    {8407,6774,10175,8595,7204,10721,8647,7346,10676,8619,7142,10489},
                    {8403,6770,10168,8591,7197,10722,8649,7353,10674,8620,7147,10494},
                    {8399,6766,10162,8588,7190,10724,8651,7359,10671,8622,7151,10499},
                    {8395,6762,10155,8585,7182,10726,8653,7366,10668,8623,7156,10504},
                    {8391,6759,10149,8581,7175,10728,8655,7373,10666,8625,7161,10509},
                    {8387,6755,10142,8578,7168,10729,8657,7380,10663,8626,7165,10514},
                    {8383,6751,10136,8574,7161,10731,8659,7386,10660,8628,7170,10519},
                    {8379,6747,10129,8570,7153,10732,8660,7393,10657,8629,7175,10524},
                    {8375,6743,10122,8567,7146,10734,8662,7400,10655,8630,7180,10529},
                    {8370,6740,10116,8563,7138,10735,8664,7407,10652,8631,7184,10534},
                    {8366,6736,10109,8559,7131,10737,8665,7413,10649,8633,7189,10539},
                    {8362,6732,10102,8555,7124,10738,8667,7420,10646,8634,7194,10544},
                    {8358,6728,10096,8551,7116,10740,8668,7426,10643,8635,7199,10549},
                    {8353,6724,10089,8547,7109,10741,8669,7433,10640,8636,7204,10554},
                    {8349,6720,10082,8543,7101,10742,8671,7439,10637,8637,7209,10559},
                    {8344,6716,10075,8539,7094,10744,8672,7446,10634,8638,7214,10564},
                    {8340,6712,10069,8534,7086,10745,8673,7452,10631,8639,7218,10568},
                    {8335,6709,10062,8530,7079,10746,8674,7459,10627,8640,7223,10573},
                    {8331,6705,10055,8526,7072,10747,8675,7465,10624,8641,7228,10578},
                    {8326,6701,10048,8521,7064,10748,8676,7472,10621,8641,7233,10583},
                    {8322,6697,10041,8517,7057,10749,8677,7478,10618,8642,7239,10587}};

unsigned short servo_position(unsigned char id,int pos)
{
    tx[0] = 0x80|id;
    tx[1] = (unsigned char)((pos & mask_h)>>7);
    tx[2] = (unsigned char)(pos & mask_l);
        
    for(i=0;i<3;i++)
    {
        serial_servo.putc(tx[i]);
    }
    return 0;
}

unsigned short servo_speed(unsigned char id,int speed)
{
        tx[0] = 0xC0|id;
        tx[1] = 0x02;
        tx[2] = 0x00|speed;        
        for(i=0;i<3;i++)
        {
            serial_servo.putc(tx[i]);
        }
        return 0;
}

void pc_command()
{
    ch = pc.getc();
    pc.putc(ch);
}

void close_motion()
{
    for(j=1;j<13;j++){
        servo_speed(j,30);
        wait_ms(2);
    }
    
    for(j=1;j<5;j++){
        servo_position(3*j-2,10167);
        wait_ms(2);
    }
    
    for(j=1;j<5;j++){
        servo_position(3*j-1,7600);
        wait_ms(2);
    }
    
    for(j=1;j<5;j++){
        servo_position(3*j,11500);
        wait_ms(2);
    }
    wait_ms(2000);
    
    for(j=1;j<5;j++){
        servo_position(3*j-1,4933);
        wait_ms(2);
    }
}

void open_motion()
{
    for(j=1;j<13;j++){
        servo_speed(j,30);
        wait_ms(2);
    }
    
    for(j=1;j<5;j++){
        servo_position(3*j-1,7600);
        wait_ms(2);
    }
    wait_ms(2000);
    
    for(j=1;j<5;j++){
        servo_position(3*j,10648);
        wait_ms(2);
    }
    wait_ms(60);
    
    for(j=1;j<5;j++){
        servo_position(3*j-2,8922);
        wait_ms(2);
    }
}

void back_motion()
{
    for(j=1;j<13;j++){
        servo_speed(j,50);
        wait_ms(2);
    }
    
    while(back_count<back_max){
        servo_position(10,back[back_count][0]);
        wait_ms(2);
        servo_position(11,back[back_count][1]);
        wait_ms(2);
        servo_position(12,back[back_count][2]);
        wait_ms(2);
        servo_position(1,back[back_count][3]);
        wait_ms(2);
        servo_position(2,back[back_count][4]);
        wait_ms(2);
        servo_position(3,back[back_count][5]);
        wait_ms(2);
        servo_position(7,back[back_count][6]);
        wait_ms(2);
        servo_position(8,back[back_count][7]);
        wait_ms(2);
        servo_position(9,back[back_count][8]);
        wait_ms(2);
        servo_position(4,back[back_count][9]);
        wait_ms(2);
        servo_position(5,back[back_count][10]);
        wait_ms(2);
        servo_position(6,back[back_count][11]);
        wait_ms(2);
        
        if(back_count==0)
        {
            wait_ms(500);
        }
        back_count++;
    }
    back_count=0;
}

void up_motion()
{
    for(j=1;j<13;j++){
        servo_speed(j,50);
        wait_ms(2);
    }
    
    while(up_count<up_max){
        servo_position(10,up[up_count][0]);
        wait_ms(2);
        servo_position(11,up[up_count][1]);
        wait_ms(2);
        servo_position(12,up[up_count][2]);
        wait_ms(2);
        servo_position(1,up[up_count][3]);
        wait_ms(2);
        servo_position(2,up[up_count][4]);
        wait_ms(2);
        servo_position(3,up[up_count][5]);
        wait_ms(2);
        servo_position(7,up[up_count][6]);
        wait_ms(2);
        servo_position(8,up[up_count][7]);
        wait_ms(2);
        servo_position(9,up[up_count][8]);
        wait_ms(2);
        servo_position(4,up[up_count][9]);
        wait_ms(2);
        servo_position(5,up[up_count][10]);
        wait_ms(2);
        servo_position(6,up[up_count][11]);
        wait_ms(2);
        
        if(up_count==0){
            wait_ms(500);
        }
        up_count++;
    }
    up_count=0;
}

void front_motion()
{
    for(j=1;j<13;j++){
        servo_speed(j,50);
        wait_ms(2);
    }
    
    while(front_count<front_max){
        servo_position(10,front[front_count][0]);
        wait_ms(2);
        servo_position(11,front[front_count][1]);
        wait_ms(2);
        servo_position(12,front[front_count][2]);
        wait_ms(2);
        servo_position(1,front[front_count][3]);
        wait_ms(2);
        servo_position(2,front[front_count][4]);
        wait_ms(2);
        servo_position(3,front[front_count][5]);
        wait_ms(2);
        
        if(front_count==0){
            wait_ms(500);
        }
        front_count++;
    }
    front_count=0;
    
    wait_ms(500);
    
    while(front_count<front_max){
        servo_position(7,front[front_count][6]);
        wait_ms(2);
        servo_position(8,front[front_count][7]);
        wait_ms(2);
        servo_position(9,front[front_count][8]);
        wait_ms(2);
        servo_position(4,front[front_count][9]);
        wait_ms(2);
        servo_position(5,front[front_count][10]);
        wait_ms(2);
        servo_position(6,front[front_count][11]);
        wait_ms(2);
        
        if(front_count==0){
            wait_ms(500);
        }
        front_count++;
    }
    front_count=0;
}

void crawl_motion()
{
    for(j=1;j<13;j++){
        servo_speed(j,50);
        wait_ms(2);
    }
    
    while(crawl_count<crawl_max){
        servo_position(10,crawl[crawl_count][0]);
        wait_ms(2);
        servo_position(11,crawl[crawl_count][1]);
        wait_ms(2);
        servo_position(12,crawl[crawl_count][2]);
        wait_ms(2);
        servo_position(1,crawl[crawl_count][3]);
        wait_ms(2);
        servo_position(2,crawl[crawl_count][4]);
        wait_ms(2);
        servo_position(3,crawl[crawl_count][5]);
        wait_ms(2);
        servo_position(7,crawl[crawl_count][6]);
        wait_ms(2);
        servo_position(8,crawl[crawl_count][7]);
        wait_ms(2);
        servo_position(9,crawl[crawl_count][8]);
        wait_ms(2);
        servo_position(4,crawl[crawl_count][9]);
        wait_ms(2);
        servo_position(5,crawl[crawl_count][10]);
        wait_ms(2);
        servo_position(6,crawl[crawl_count][11]);
        wait_ms(2);
        
        if(crawl_count==0){
            wait_ms(500);
        }
        crawl_count++;
    }
    crawl_count=0;
}

void step()
{
    for(j=1;j<13;j++){
        servo_speed(j,50);
        wait_ms(2);
    }
    
    servo_position(10,6222);
    wait_ms(20);
    servo_position(11,7600);
    wait_ms(20);
    servo_position(12,8502);
    wait_ms(20);
    servo_position(1,8687);
    wait_ms(20);
    servo_position(2,7600);
    wait_ms(20);
    servo_position(3,10547);
    wait_ms(20);
    servo_position(7,6222);
    wait_ms(20);
    servo_position(8,7600);
    wait_ms(20);
    servo_position(9,8502);
    wait_ms(20);
    servo_position(4,8687);
    wait_ms(20);
    servo_position(5,7600);
    wait_ms(20);
    servo_position(6,10547);
    wait_ms(20);
}

void back_step()
{
    for(j=1;j<13;j++){
        servo_speed(j,50);
        wait_ms(2);
    }
    
    while(bstep_count<bstep_max){
        if(bstep_count == 99){
            servo_position(9,7500);
            wait_ms(2);
        }
        
        servo_position(10,bstep[bstep_count][0]);
        wait_ms(2);
        servo_position(11,bstep[bstep_count][1]);
        wait_ms(2);
        servo_position(12,bstep[bstep_count][2]);
        wait_ms(2);
        servo_position(1,bstep[bstep_count][3]);
        wait_ms(2);
        servo_position(2,bstep[bstep_count][4]);
        wait_ms(2);
        servo_position(3,bstep[bstep_count][5]);
        wait_ms(2);
        servo_position(7,bstep[bstep_count][6]);
        wait_ms(2);
        servo_position(8,bstep[bstep_count][7]);
        wait_ms(2);
        servo_position(9,bstep[bstep_count][8]);
        wait_ms(2);
        servo_position(4,bstep[bstep_count][9]);
        wait_ms(2);
        servo_position(5,bstep[bstep_count][10]);
        wait_ms(2);
        servo_position(6,bstep[bstep_count][11]);
        wait_ms(2);
        
        if(bstep_count==0){
            wait_ms(500);
        }
        bstep_count++;
    }
    bstep_count=0;
}

void end_motion()
{
    for(j=1;j<13;j++){
        servo_speed(j,30);
        wait_ms(2);
    }
    
    for(j=1;j<5;j++){
        servo_position(3*j-1,7600);
        wait_ms(2);
    }
    wait_ms(20);
    
    for(j=1;j<5;j++){
        servo_position(3*j,10318);
        wait_ms(2);
    }
    wait_ms(20);
    
    for(j=1;j<5;j++){
        servo_position(3*j-2,8253);
        wait_ms(2);
    }
}

int main()
{
    wait_ms(500);
    serial_servo.baud(115200);
    serial_servo.format(8,Serial::Even,1);
    
    pc.baud(115200);
    pc.format(8,Serial::None,1);
    
    pc.printf("key:");
    pc.attach(pc_command,Serial::RxIrq);
    
    while(1)
    {
        switch(ch)
        {
            case 'c':
            close_motion();
            wait_ms(20);
            ch = 0;
            flag_close = ON;
            flag_open = OFF;
            break;
                
            case 'o':
            if(flag_close == ON){
                open_motion();
                wait_ms(20);
                flag_close = OFF;
                flag_open = ON;
            }
            ch = 0;
            break;
            
            case '1':
            if(flag_open == ON){
                back_motion();
                wait_ms(20);
                flag_open = OFF;
                flag_back = ON;
            }
            ch = 0;
            break;
            
            case '2':
            if(flag_back == ON){
                up_motion();
                wait_ms(20);
                flag_back = OFF;
                flag_up = ON;
            }
            ch = 0;
            break;
            
            case '3':
            if(flag_up == ON){
                front_motion();
                wait_ms(20);
                flag_up = OFF;
                flag_front = ON;
            }
            ch = 0;
            break;
            
            case 'k':
            if(flag_front == ON){
                crawl_motion();
                wait_ms(20);
                flag_crawl = ON;
            }
            ch = 0;
            break;
            
            case '4':
            if(flag_crawl == ON){
                step();
                wait_ms(20);
                flag_crawl = OFF;
                flag_step = ON;
            }
            ch = 0;
            break;
            
            case '5':
            if(flag_step == ON){
                back_step();
                wait_ms(20);
                flag_step = OFF;
                flag_bstep = ON;
            }
            ch = 0;
            break;
            
            case '6':
            if(flag_bstep == ON){
                end_motion();
                wait_ms(20);
                flag_bstep = OFF;
            }
            ch = 0;
            break;
            
            default:
            break;
        }
    }
}